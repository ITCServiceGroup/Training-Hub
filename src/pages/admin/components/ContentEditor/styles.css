/* CraftEditor Styles */

/* Viewport */
.viewport {
  width: 100%;
  height: 100%;
  position: relative;
  overflow: hidden;
}

/* Toolbox */
.toolbox-item {
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: #f3f4f6;
  border-radius: 4px;
  cursor: move;
  color: #4b5563;
  transition: all 0.2s;
}

.dark .toolbox-item {
  background-color: #334155;
  color: #e2e8f0;
}

.toolbox-item:hover {
  background-color: #e5e7eb;
  color: #111827;
}

.dark .toolbox-item:hover {
  background-color: #475569;
  color: #f8fafc;
}

/* Craft Node Styles */
.craftjs-node-selected {
  position: relative;
}

/* Ensure labels are properly positioned */
.craft-node-label {
  position: absolute !important;
  top: -26px !important;
  left: 0 !important;
  z-index: 11 !important;
  background-color: #0d9488 !important; /* teal-600 */
  color: white !important;
  padding: 4px 6px !important;
  font-size: 12px !important;
  border-radius: 3px !important;
  cursor: default !important;
  user-select: none !important;
  display: flex !important;
  align-items: center !important;
  gap: 6px !important;
  box-shadow: 0 1px 3px rgba(0,0,0,0.2) !important;
  pointer-events: auto !important;
}

/* Style the move handle */
.move-handle {
  cursor: move !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  padding: 4px !important;
  border-radius: 3px !important;
  transition: background-color 0.2s !important;
  width: 24px !important;
  height: 24px !important;
  pointer-events: auto !important;
}

.move-handle:hover {
  background-color: rgba(255, 255, 255, 0.3) !important;
}

.move-handle:active {
  background-color: rgba(255, 255, 255, 0.4) !important;
}

/* Make sure the move handle is always visible and clickable */
.craft-node-label .move-handle {
  z-index: 999 !important;
  position: relative !important;
}

/* Dark mode support */
.dark .craftjs-node-selected {
  outline: none !important; /* Remove default outline */
}

.dark .craft-node-indicator {
  outline-color: #0d9488 !important; /* teal-600 in dark mode */
}

.dark .react-resizable {
  border-color: #4b5563 !important; /* gray-600 in dark mode */
}

/* Container styles */
.craft-container {
  min-height: 50px;
  transition: border-color 0.2s;
  width: 100%;
  height: 100%;
  /* Ensure Container components have no default border/outline */
  border: none !important; /* Use !important if necessary to override other styles */
  outline: none !important;
}

/* Text styles */
[contenteditable] {
  outline: none;
  cursor: text;
}

/* Text components should have solid border when selected, but dashed when hovered */
[contenteditable].component-selected::after {
  border-style: solid !important;
}

[contenteditable].component-hovered::after {
  border-style: dashed !important;
}

/* Button styles */
.craft-button {
  transition: all 0.2s;
}

.craft-button:hover {
  opacity: 0.9;
  transform: translateY(-1px);
}

/* Button components should have solid border when selected, but dashed when hovered */
.craft-button.component-selected::after {
  border-style: solid !important;
}

.craft-button.component-hovered::after {
  border-style: dashed !important;
}

/* Image styles */
.craft-image-container {
  position: relative;
  box-sizing: border-box;
}

.craft-image {
  max-width: 100%;
  height: auto;
  display: block;
}

/* Image components should have dashed border when selected, and dashed when hovered */
.craft-image-container.component-selected::after {
  border: 2px dashed #0d9488 !important;
}

.craft-image-container.component-hovered::after {
  border: 2px dashed #0d9488 !important;
}

/* Card styles */
.craft-card {
  transition: all 0.2s;
  /* Remove overflow: hidden to prevent clipping of resize handles */
}

/* Card components should have dashed border when selected or hovered */
.craft-card.component-selected::after {
  border: 2px dashed #0d9488 !important;
}

.craft-card.component-hovered::after {
  border: 2px dashed #0d9488 !important;
}

/* Ensure proper z-index for card components */
.craft-card.craftjs-node-selected {
  z-index: 1;
}

/* Toolbar styles */
.craft-toolbar {
  box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.1);
  transition: all 0.2s ease;
}

.toolbar-button {
  transition: all 0.2s ease;
}

.toolbar-button:hover {
  background-color: rgba(0, 0, 0, 0.2);
}

/* Drag and drop styles */
.craftjs-renderer [data-dragging] {
  opacity: 0.5;
  position: relative;
  z-index: 100;
}

.craftjs-renderer [data-dragging]::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(13, 148, 136, 0.1);
  border: 2px dashed #0d9488;
  pointer-events: none;
  z-index: 1;
}

.craftjs-renderer [data-drag-hover] {
  position: relative;
  z-index: 1;
  outline: 2px dashed #0d9488 !important;
  outline-offset: -2px;
  background-color: rgba(13, 148, 136, 0.05) !important;
}

/* Resizable styles */
.react-resizable {
  position: relative;
}

.resizable-border {
  position: relative;
}

.resizable-border::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  border: 1px dashed #ccc;
  pointer-events: none;
  z-index: 1;
}

.dark .resizable-border::after {
  border-color: #4b5563;
}

/* Ensure the Resizable component's border aligns with resize handles */
.react-resizable {
  box-sizing: border-box;
  position: relative;
}

/* Node indicator styles */
.craft-node-indicator {
  pointer-events: none;
  transition: all 0.2s ease;
}

/* Selected component styles */
.component-selected {
  position: relative; /* Needed for ::after */
}

/* Sidebar styles */
.sidebar {
  width: 260px;
}

/* Renderer styles */
.craftjs-renderer {
  background-color: #f9fafb;
  min-height: 500px;
}

.dark .craftjs-renderer {
  background-color: #1e293b;
}

/* Component Selection and Hover Styles - Based on Craft.js Landing Example */

/* Base style for selected components */
.component-selected, .component-hovered {
  position: relative;
}

/* Border style for all selected components using ::after pseudo-element */
.component-selected::after {
  content: ' ';
  border: 2px dashed #0d9488; /* teal-600 color */
  width: 100%;
  height: 100%;
  position: absolute;
  left: 0;
  top: 0;
  pointer-events: none;
  display: block;
  box-sizing: border-box;
  z-index: 1;
}

/* Border style for all hovered components using ::after pseudo-element */
.component-hovered::after {
  content: ' ';
  border: 2px dashed #0d9488; /* teal-600 color */
  width: 100%;
  height: 100%;
  position: absolute;
  left: 0;
  top: 0;
  pointer-events: none;
  display: block;
  box-sizing: border-box;
  z-index: 1;
}

/* Special handling for Container component to account for top margin */
/* Create a pseudo-element for the top margin */
.container-with-top-margin::before {
  content: '';
  display: block;
  position: absolute;
  top: calc(-1 * var(--top-margin, 0px));
  left: 0;
  width: 100%;
  height: var(--top-margin, 0px);
  pointer-events: none;
  z-index: 0;
}

/* Adjust the selection box to include the top margin */
.container-with-top-margin.component-selected::after,
.container-with-top-margin.component-hovered::after {
  top: calc(-1 * var(--top-margin, 0px));
  height: calc(100% + var(--top-margin, 0px));
  z-index: 1;
}

/* Ensure table components don't get double borders */
.craft-table.component-selected::after,
.craft-table.component-hovered::after {
  display: none !important;
}


/* Ensure resizable elements have proper overflow handling */
.react-resizable {
  overflow: visible !important; /* Ensure borders aren't clipped */
  box-sizing: border-box !important;
}

/* Hide default resize handles from re-resizable */
.react-resizable-handle {
  display: none;
}

/* Make default resize handles visible but transparent for tables */
.craft-table .react-resizable-handle {
  display: block !important;
  opacity: 0 !important;
  width: 30px !important;
  height: 30px !important;
  background-image: none !important;
  background-color: transparent !important;
  pointer-events: none !important; /* Default to none */
}

/* Only enable pointer events on resize handles when table is selected */
.craft-table.component-selected .react-resizable-handle {
  pointer-events: auto !important;
}

/* Ensure proper stacking context for resize handles */
.craft-image-container.craftjs-node-selected,
.craft-card.craftjs-node-selected,
.craft-container.craftjs-node-selected,
.craft-table.craftjs-node-selected {
  z-index: 1;
}

/* Ensure resizable container doesn't clip resize handles */
.react-resizable {
  overflow: visible !important;
}

/* Special handling for re-resizable elements inside tables */
.table-fix:not(.component-selected) .react-resizable,
.table-fix:not(.component-selected) .react-resizable-handle {
  pointer-events: none !important;
}

/* Table styles */
.craft-table {
  position: relative;
  width: 100%;
  height: 100%;
  border-collapse: collapse;
  table-layout: fixed; /* Add fixed table layout */
  box-sizing: border-box !important;
}

/* Table cell container */
.craft-table table {
  width: 100%;
  height: 100%;
  border-spacing: 0;
  border-collapse: collapse;
  box-sizing: border-box !important;
}

/* Style table cells */
.craft-table td {
  position: relative;
  vertical-align: top;
  min-width: 50px;
  box-sizing: border-box !important;
}

/* Ensure Text components within table cells take full width */
.craft-table td .craft-text {
  width: 100%;
  display: block;
  min-height: 24px;
}

/* TableText component styles */
.craft-table-text {
  width: 100%;
  display: block;
  min-height: 24px;
  white-space: normal;
  word-wrap: break-word;
  overflow-wrap: break-word;
  cursor: text;
}

/* Ensure TableText components are properly styled in table cells */
.craft-table td .craft-table-text {
  width: 100%;
  display: block;
  min-height: 24px;
}

/* Table management buttons container */
.craft-table-controls {
  margin-bottom: 8px;
}

/* Table management controls */
.craft-table-management-btn {
  font-size: 12px;
  padding: 4px 8px;
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.2s;
}

.craft-table-management-btn:hover {
  transform: translateY(-1px);
}

/* Table cell styles */
.craft-table-cell {
  padding: 8px;
  position: relative;
  vertical-align: top;
  min-width: 50px;
  box-sizing: border-box;
}

/* Dark mode table cells */
.dark .craft-table {
  border-color: #374151;
}

.dark .craft-table-cell {
  border-color: #374151;
}

/* Table header cell styles */
.craft-table-header {
  background-color: #f3f4f6;
  font-weight: 500;
}

.dark .craft-table-header {
  background-color: #374151;
}

/* Alternating row styles */
.craft-table-row-alternate {
  background-color: #f9fafb;
}

.dark .craft-table-row-alternate {
  background-color: #1f2937;
}

/* Column resize handle */
.column-resize-handle {
  background-color: transparent;
  transition: background-color 0.2s;
}

.column-resize-handle:hover {
  background-color: rgba(13, 148, 136, 0.5);
}

/* Row resize handle */
.row-resize-handle {
  background-color: transparent;
  transition: background-color 0.2s;
}

.row-resize-handle:hover {
  background-color: rgba(13, 148, 136, 0.5);
}

/* Table components should have dashed border when selected or hovered */
.craft-table.component-selected::after,
.craft-table.component-hovered::after {
  display: none !important; /* Remove the inner border */
}

.craft-table.component-selected {
  outline: 2px dashed #0d9488 !important;
  outline-offset: 0px !important;
  box-shadow: 0 0 0 4px rgba(255, 255, 255, 0.5);
}

.craft-table.component-hovered {
  outline: 2px dashed #0d9488 !important;
  outline-offset: 0px !important;
}

/* Ensure the Resizer component's children take full width and height */
.craft-table > div {
  width: 100% !important;
  height: 100% !important;
  box-sizing: border-box !important;
}

/* Position the default resize handles for tables */
.craft-table .react-resizable-handle-nw,
.craft-table .react-resizable-handle-ne,
.craft-table .react-resizable-handle-sw,
.craft-table .react-resizable-handle-se {
  position: absolute !important;
  z-index: 998 !important;
}

/* Add custom resize handles for tables */
.craft-table .table-handle-tl,
.craft-table .table-handle-tr,
.craft-table .table-handle-bl,
.craft-table .table-handle-br {
  position: absolute;
  width: 10px;
  height: 10px;
  background-color: #0d9488;
  border-radius: 50%;
  border: 2px solid #fff;
  box-shadow: 0px 0px 12px -1px rgba(0, 0, 0, 0.25);
  z-index: 100;
  pointer-events: auto; /* These are only rendered when table is selected anyway */
  cursor: pointer;
  display: none; /* Hide by default */
}

/* Only show resize handles when table is selected */
.craft-table.component-selected .table-handle-tl,
.craft-table.component-selected .table-handle-tr,
.craft-table.component-selected .table-handle-bl,
.craft-table.component-selected .table-handle-br {
  display: block;
}

/* Top-left handle */
.craft-table .table-handle-tl {
  top: -7px;
  left: -7px;
  cursor: nw-resize;
  z-index: 999;
}

/* Top-right handle */
.craft-table .table-handle-tr {
  top: -7px;
  right: -7px;
  cursor: ne-resize;
  z-index: 999;
}

/* Bottom-left handle */
.craft-table .table-handle-bl {
  bottom: -7px;
  left: -7px;
  cursor: sw-resize;
  z-index: 999;
}

/* Bottom-right handle */
.craft-table .table-handle-br {
  bottom: -7px;
  right: -7px;
  cursor: se-resize;
  z-index: 999;
}

/* Dark mode styling */
.dark .craft-table.component-selected {
  box-shadow: 0 0 0 4px rgba(31, 41, 55, 0.5);
}

.dark .craft-table .table-handle-tl,
.dark .craft-table .table-handle-tr,
.dark .craft-table .table-handle-bl,
.dark .craft-table .table-handle-br {
  border-color: #1f2937;
  background-color: #0d9488;
  box-shadow: 0px 0px 12px -1px rgba(0, 0, 0, 0.4);
}

/* Fix for table blocking pointer events to components below it - AGGRESSIVE VERSION */
.table-outer-wrapper .table-fix {
  pointer-events: none !important;
}

/* Only enable pointer events when the table is selected */
.table-outer-wrapper .table-fix.component-selected {
  pointer-events: auto !important;
}

/* Ensure all elements inside a selected table can receive pointer events */
.table-outer-wrapper .table-fix.component-selected * {
  pointer-events: auto !important;
}

/* Make sure the table outer wrapper doesn't block pointer events */
.table-outer-wrapper {
  pointer-events: none !important;
}

/* Special handling for the table content to make it clickable even when not selected */
.table-outer-wrapper .table-fix:not(.component-selected) .table-content-wrapper {
  pointer-events: auto !important;
}

/* Make sure the table itself can be clicked */
.table-outer-wrapper .table-fix:not(.component-selected) .table-content-wrapper > table {
  pointer-events: auto !important;
}

/* Ensure all other elements inside the table don't block pointer events when not selected */
.table-outer-wrapper .table-fix:not(.component-selected) * {
  pointer-events: none !important;
}

/* Override the above rule for the table and its direct wrapper */
.table-outer-wrapper .table-fix:not(.component-selected) .table-content-wrapper,
.table-outer-wrapper .table-fix:not(.component-selected) .table-content-wrapper > table {
  pointer-events: auto !important;
}

/* Create a transparent overlay that can be clicked to select the table */
.table-outer-wrapper .table-fix:not(.component-selected)::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: 1;
  pointer-events: auto !important;
  cursor: pointer;
}

/* Styling for the table outer wrapper */
.table-outer-wrapper {
  display: inline-block;
  position: relative;
  box-sizing: content-box;
}

/* Ensure the table wrapper doesn't affect the table's dimensions */
.table-outer-wrapper .craft-table {
  display: block;
  box-sizing: border-box;
}

/* Make sure the resize handles are positioned relative to the table, not the wrapper */
.table-outer-wrapper .craft-table .react-resizable-handle,
.table-outer-wrapper .craft-table .table-handle-tl,
.table-outer-wrapper .craft-table .table-handle-tr,
.table-outer-wrapper .craft-table .table-handle-bl,
.table-outer-wrapper .craft-table .table-handle-br {
  position: absolute;
}
